<p>新建立一个项目，经常会涉及到数据库的频繁改动，数据处理等，可以整合起来放到脚本，方便操作。</p>


<hr />

<p>下面将数据库创建，删除，导入，导出数据等重复性比较高的操作整合到 <a href="https://github.com/wenfh2020/shell/blob/master/db.sh">shell 脚本</a>。</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#!/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="o">#</span> <span class="n">wfh</span><span class="o">/</span><span class="mi">2018</span><span class="o">/</span><span class="mi">09</span><span class="o">/</span><span class="mi">18</span> <span class="o">-</span> <span class="n">operate</span> <span class="k">for</span> <span class="n">db</span><span class="p">:</span> <span class="k">create</span><span class="p">,</span> <span class="k">drop</span><span class="p">,</span> <span class="n">import</span><span class="p">,</span> <span class="n">dump</span><span class="p">.</span>

<span class="n">DB_HOST</span><span class="o">=</span><span class="nv">"127.0.0.1"</span>
<span class="n">DB_PORT</span><span class="o">=</span><span class="mi">3306</span>
<span class="n">DB_USER</span><span class="o">=</span><span class="n">root</span>
<span class="n">DB_PWD</span><span class="o">=</span><span class="mi">123</span><span class="o">!@#</span>
<span class="n">DB_NAME</span><span class="o">=</span><span class="n">db_test</span>
<span class="n">DB_IMPORT_FILE</span><span class="o">=</span><span class="nv">"${DB_NAME}.sql"</span>
<span class="n">DB_DUMP_FILE</span><span class="o">=</span><span class="nv">"${DB_NAME}_dump.sql"</span>
<span class="k">SQL</span><span class="o">=</span><span class="nv">""</span>

<span class="n">clear</span>

<span class="k">case</span> <span class="nv">"$1"</span> <span class="k">in</span>
    <span class="nv">"help"</span><span class="p">)</span>
        <span class="n">echo</span> <span class="nv">"drop"</span>
        <span class="n">echo</span> <span class="nv">"create"</span>
        <span class="n">echo</span> <span class="nv">"import"</span>
        <span class="n">echo</span> <span class="nv">"dump"</span>
        <span class="p">;;</span>
    <span class="nv">"drop"</span><span class="p">)</span>
        <span class="n">echo</span> <span class="nv">"${DB_USER} drop database: ${DB_NAME}"</span>
        <span class="k">SQL</span><span class="o">=</span><span class="nv">"DROP DATABASE IF EXISTS ${DB_NAME}"</span>
        <span class="n">mysql</span> <span class="o">-</span><span class="n">h</span><span class="err">$</span><span class="n">DB_HOST</span> <span class="o">-</span><span class="n">P</span><span class="err">$</span><span class="n">DB_PORT</span> <span class="o">-</span><span class="n">u</span><span class="err">$</span><span class="n">DB_USER</span> <span class="o">-</span><span class="n">p</span><span class="err">$</span><span class="n">DB_PWD</span> <span class="o">-</span><span class="n">Ns</span> <span class="o">-</span><span class="n">e</span> <span class="nv">"$SQL"</span>
        <span class="p">;;</span>
    <span class="nv">"create"</span><span class="p">)</span>
        <span class="n">echo</span> <span class="nv">"${DB_USER} create database: ${DB_NAME}}"</span>
        <span class="k">SQL</span><span class="o">=</span><span class="nv">"CREATE DATABASE IF NOT EXISTS $DB_NAME DEFAULT CHARSET utf8mb4 COLLATE utf8mb4_general_ci"</span>
        <span class="n">mysql</span> <span class="o">-</span><span class="n">h</span><span class="err">$</span><span class="n">DB_HOST</span> <span class="o">-</span><span class="n">P</span><span class="err">$</span><span class="n">DB_PORT</span> <span class="o">-</span><span class="n">u</span><span class="err">$</span><span class="n">DB_USER</span> <span class="o">-</span><span class="n">p</span><span class="err">$</span><span class="n">DB_PWD</span> <span class="o">-</span><span class="n">Ns</span> <span class="o">-</span><span class="n">e</span> <span class="nv">"$SQL"</span>
        <span class="p">;;</span>
    <span class="nv">"import"</span><span class="p">)</span>
        <span class="n">echo</span> <span class="nv">"${DB_USER} import data from: ${DB_IMPORT_FILE}"</span>
        <span class="n">mysql</span> <span class="o">-</span><span class="n">h</span><span class="err">$</span><span class="n">DB_HOST</span> <span class="o">-</span><span class="n">P</span><span class="err">$</span><span class="n">DB_PORT</span> <span class="o">-</span><span class="n">u</span><span class="err">$</span><span class="n">DB_USER</span> <span class="o">-</span><span class="n">p</span><span class="err">$</span><span class="n">DB_PWD</span> <span class="err">$</span><span class="n">DB_NAME</span> <span class="o">&lt;</span> <span class="nv">"${DB_IMPORT_FILE}"</span>
        <span class="p">;;</span>
    <span class="nv">"dump"</span><span class="p">)</span>
        <span class="n">echo</span> <span class="nv">"${DB_USER} dump data from ${DB_NAME} to ${DB_DUMP_FILE}"</span>
        <span class="n">mysqldump</span> <span class="o">-</span><span class="n">h</span><span class="err">$</span><span class="n">DB_HOST</span> <span class="o">-</span><span class="n">P</span><span class="err">$</span><span class="n">DB_PORT</span> <span class="o">-</span><span class="n">u</span><span class="err">$</span><span class="n">DB_USER</span> <span class="o">-</span><span class="n">p</span><span class="err">$</span><span class="n">DB_PWD</span> <span class="err">$</span><span class="n">DB_NAME</span> <span class="o">&gt;</span> <span class="nv">"${DB_DUMP_FILE}"</span>
        <span class="p">;;</span>
    <span class="o">*</span><span class="p">)</span>
        <span class="n">echo</span> <span class="nv">"invalid cmd! find for help!"</span>
        <span class="n">exit</span> <span class="mi">1</span>
        <span class="p">;;</span>
<span class="n">esac</span>

<span class="n">exit</span> <span class="mi">0</span>
</code></pre></div></div>

<hr />

<blockquote>
  <p>🔥文章来源：<a href="https://wenfh2020.com/">wenfh2020.com</a></p>
</blockquote>
