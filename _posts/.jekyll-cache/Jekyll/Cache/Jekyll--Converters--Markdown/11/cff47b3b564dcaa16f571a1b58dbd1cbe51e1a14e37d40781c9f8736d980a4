I"W<p>程序的工作流程：高级语言 -&gt; 编译器 -&gt; 低级语言指令 -&gt; 系统管理运行程序 &lt;—&gt; 硬件。</p>

<ul id="markdown-toc">
  <li><a href="#1-进程虚拟内存" id="markdown-toc-1-进程虚拟内存">1. 进程虚拟内存</a></li>
  <li><a href="#2-工作流程" id="markdown-toc-2-工作流程">2. 工作流程</a></li>
  <li><a href="#3-参考" id="markdown-toc-3-参考">3. 参考</a></li>
</ul>

<h2 id="1-进程虚拟内存">1. 进程虚拟内存</h2>

<p>进程不允许直接访问物理内存，系统通过虚拟内存方式管理进程内存。</p>

<p><img src="/images/2020-02-20-14-22-08.png" alt="进程地址空间" data-action="zoom" /></p>

<blockquote>
  <p>图片来源 《深入理解计算机系统》8.2.3 私有地址空间</p>
</blockquote>

<hr />

<h2 id="2-工作流程">2. 工作流程</h2>

<p>高级语言 -&gt; 编译器 -&gt; 低级语言指令 -&gt; 系统加载运行</p>

<ul>
  <li>程序编译执行流程。</li>
</ul>

<p><img src="/images/2020-04-28-12-54-46.png" alt="编译流程" data-action="zoom" /></p>

<ul>
  <li>程序启动退出流程。</li>
</ul>

<p><img src="/images/2020-04-29-10-38-48.png" alt="程序启动退出流程" data-action="zoom" /></p>

<blockquote>
  <p>图片来源： 《UNIX 环境高级编程》7.3.2 atexit函数</p>
</blockquote>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// glibc - start.c</span>
<span class="k">static</span> <span class="kt">void</span>
<span class="n">start1</span> <span class="p">(</span><span class="n">ARG_DUMMIES</span> <span class="n">argc</span><span class="p">,</span> <span class="n">argp</span><span class="p">)</span>
     <span class="n">DECL_DUMMIES</span>
     <span class="kt">int</span> <span class="n">argc</span><span class="p">;</span>
     <span class="kt">char</span> <span class="o">*</span><span class="n">argp</span><span class="p">;</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">argp</span><span class="p">;</span>

  <span class="cm">/* The environment starts just after ARGV.  */</span>
  <span class="n">__environ</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">argv</span><span class="p">[</span><span class="n">argc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>

  <span class="cm">/* If the first thing after ARGV is the arguments
     themselves, there is no environment.  */</span>
  <span class="k">if</span> <span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span> <span class="n">__environ</span> <span class="o">==</span> <span class="o">*</span><span class="n">argv</span><span class="p">)</span>
    <span class="cm">/* The environment is empty.  Make __environ
       point at ARGV[ARGC], which is NULL.  */</span>
    <span class="o">--</span><span class="n">__environ</span><span class="p">;</span>

  <span class="cm">/* Do C library initializations.  */</span>
  <span class="n">__libc_init</span> <span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="n">__environ</span><span class="p">);</span>

  <span class="cm">/* Call the user program.  */</span>
  <span class="n">exit</span> <span class="p">(</span><span class="n">main</span> <span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="n">__environ</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>程序运行流程。</li>
</ul>

<p><img src="/images/2020-04-29-11-39-52.png" alt="程序运行流程" data-action="zoom" /></p>

<hr />

<h2 id="3-参考">3. 参考</h2>

<ul>
  <li>《深入理解计算机系统》</li>
  <li>《UNIX 环境高级编程》</li>
</ul>

<hr />

<blockquote>
  <p>🔥文章来源：<a href="https://wenfh2020.com/2020/04/29/proc-workflow/">wenfh2020.com</a></p>
</blockquote>
:ET