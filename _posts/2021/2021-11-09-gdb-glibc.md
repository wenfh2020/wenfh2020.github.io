---
layout: post
title:  "ï¼ˆCentos 7ï¼‰GDB è°ƒè¯• glibcï¼ˆé™„è§†é¢‘ï¼‰"
categories: tool
tags: gdb glibc
author: wenfh2020
---

glibc è¿™ä¸ª c åº“ï¼Œå°è£…äº†å¾ˆå¤šä»£ç ï¼Œå¯ä»¥é€šè¿‡ gdb è°ƒè¯•è¿›å»æ·±å…¥ç†è§£åº•å±‚æºç ã€‚



* content
{:toc}

---

## 1. glibc åº“ä½œç”¨

glibc å¾ˆå¤šæ—¶å€™ä½œä¸ºåº”ç”¨ç¨‹åºä¸å†…æ ¸ä¹‹é—´äº¤äº’çš„è¿‡æ¸¡è§’è‰²ï¼Œå¤„ç†äº†å¾ˆå¤šæºç å·¥ä½œç»†èŠ‚ã€‚

<div align=center><img src="/images/2021-11-10-09-31-37.png" data-action="zoom"/></div>

> å›¾ç‰‡æ¥æºï¼šã€ŠLinux å†…æ ¸è®¾è®¡ä¸å®ç°ã€‹- ç¬¬äº”ç«  - ç³»ç»Ÿè°ƒç”¨

---

## 2. gdb è°ƒè¯•æ•ˆæœ

<div align=center><img src="/images/2021-11-09-14-34-16.png" data-action="zoom" width="80%"/></div>

---

## 3. æ’ä»¶å®‰è£…

* ç³»ç»Ÿ

```shell
# uname -r
3.10.0-957.21.3.el7.x86_64
```

* é…ç½® yum å®‰è£…è°ƒè¯•æ’ä»¶ä»“åº“è·¯å¾„ã€‚

```shell
# è®¾ç½®é•œåƒè·¯å¾„ã€‚
vim /etc/yum.repos.d/CentOS-Debuginfo.repo

# å¡«å……ä¸‹é¢å†…å®¹ã€‚
#------------------------------
[base-debuginfo]
name=Centos-7 - Debuginfo
baseurl=http://debuginfo.centos.org/7/$basearch/
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-Debug-7
enable=1
#------------------------------
```

* å®‰è£…ç›¸åº”çš„è°ƒè¯•æ’ä»¶ã€‚debuginfo-install åº”è¯¥å®‰è£…å“ªä¸ªç‰ˆæœ¬çš„è°ƒè¯•ä¿¡æ¯ï¼Œå¦‚æœä¸æ¸…æ¥šï¼Œå¯ä»¥å†™æµ‹è¯•ä»£ç é€šè¿‡ gdb è°ƒè¯•ï¼Œç¼ºå°‘çš„æ’ä»¶ï¼Œgdb ä¼šæç¤ºï¼Œå®‰è£…å³å¯ã€‚

```shell
yum install nss-softokn-debuginfo â€“nogpgcheck
yum install yum-utils gdb gcc-c++
debuginfo-install glibc-2.17-260.el7_6.6.x86_64 libgcc-4.8.5-44.el7.x86_64 libstdc++-4.8.5-44.el7.x86_64
```

---

## 4. æµ‹è¯•æºç 

```c
/* gcc -g -O0 test.c -o test */
#include <stdio.h>
#include <string.h>

int main(int argc, char** argv) {
    char test[2];
    const char* p = "hello world";

    printf("%s", "snprintf: ");
    snprintf(test, sizeof(test), "%s", p);
    printf("%s\n", test);
}
```

---

## 5. è°ƒè¯•è§†é¢‘

è§†é¢‘è¿æ¥ï¼š[(Centos) Debugging in glibc with gdb](https://www.bilibili.com/video/BV1864y1i7PQ/)

<iframe class="bilibili" src="//player.bilibili.com/player.html?aid=760200877&bvid=BV1864y1i7PQ&cid=328168319&page=1&high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>

---

## 6. åè®°

æ€¥ç€è°ƒè¯•ç¡®è®¤ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œæ‰‹ä¸Šçš„äº‘ä¸»æœºä»¥å‰æ˜¯å¯ä»¥è°ƒè¯• libc åº“çš„ï¼Œåé¢å› ä¸ºè£…äº†ä¸å°‘ç‰ˆæœ¬çš„ gdbï¼Œä¸çŸ¥ä¸ºå•¥ï¼Œç°åœ¨è°ƒè¯•æ­»æ´»è·³ä¸è¿› libc çš„ä»£ç äº†ï¼Œè™šæ‹Ÿæœºè·‘ä¸ªéä¹Ÿæ²¡æŠ˜è…¾å¥½ ğŸ˜­ã€‚

æœ€åèŠ±äº† 22 å—é’±ä¹°äº†ä¸ªä¸€æ˜ŸæœŸæ—¶é™çš„æœ€ä½é…çš„é˜¿é‡Œäº‘å…±äº«å‹ä¸»æœºé‡æ–°æµ‹è¯•ï¼Œä¸€ä¸‹å°±ææ‚äº†ï¼Œç›¸æ¯”é‡æ–°å®‰è£…ä¸€ä¸ªè™šæ‹Ÿæœºå€’è…¾çš„æ—¶é—´æˆæœ¬åˆ’ç®—å¤šäº†ã€‚â€”â€”ä»˜è´¹æ€ç»´ç°åœ¨æ„Ÿè§‰å¼€å§‹æ…¢æ…¢è½¬å˜ã€‚
