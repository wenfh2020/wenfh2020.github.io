---
layout: post
title:  "[redis æºç èµ°è¯»] sentinel å“¨å…µ"
categories: redis
tags: redis sentinel
author: wenfh2020
---

redis æœ‰ä¸»ä»æ•°æ®å¤åˆ¶åŠŸèƒ½ã€‚å¤šä¸ªå®ä¾‹é€šè¿‡è¯»å†™åˆ†ç¦»ï¼Œä½¿å¾—å•è¿›ç¨‹çš„ redis å¯ä»¥å……åˆ†åˆ©ç”¨å¤šæ ¸æ€§èƒ½ã€‚

ä¸€èˆ¬æƒ…å†µä¸‹ master å¯è¯»å¯å†™ï¼Œslave åªè¯»ã€‚å½“ master èŠ‚ç‚¹æ‰çº¿æˆ–å¼‚å¸¸é€€å‡ºåï¼Œredis é›†ç¾¤åªå‰©ä¸‹ slave èŠ‚ç‚¹ï¼Œå®ƒä»¬ä¸æ”¯æŒå†™æ“ä½œã€‚è¿™æ—¶å¿…é¡»é‡æ–°æ‰¾ä¸€ä¸ª masterï¼Œæ–¹æ³•å°±æ˜¯ä»å‰©ä¸‹çš„ slave èŠ‚ç‚¹ä¸­ï¼Œé€‰å‡ºä¸€ä¸ªï¼Œå¹¶æŠŠå®ƒè§’è‰²è½¬å˜ä¸º masterï¼Œä½¿å¾— redis é›†ç¾¤èƒ½æ¢å¤å·¥ä½œã€‚

è¿™æ—¶æ•…éšœè½¬ç§»ç®¡ç†è€… `sentinel` åº”è¿è€Œç”Ÿã€‚å®ƒè´Ÿè´£ redis é›†ç¾¤ç®¡ç†å·¥ä½œï¼Œä¿è¯é«˜å¯ç”¨æ€§èƒ½ã€‚



* content
{:toc}

---

## 1. sentinel ä½œç”¨

1. ç›‘æ§ï¼š æ£€æŸ¥ redis èŠ‚ç‚¹å¥åº·çŠ¶å†µã€‚
2. æ•…éšœè½¬ç§»ï¼šå½“ redis é›†ç¾¤èŠ‚ç‚¹å‡ºç°æ•…éšœæ—¶ï¼ŒåŠæ—¶è‡ªåŠ¨è¿›è¡Œæ•…éšœè½¬ç§»ã€‚
3. é€šçŸ¥ï¼šæ£€æµ‹åˆ° redis å®ä¾‹å‡ºç°æ•…éšœï¼Œé€šè¿‡ api è¿›è¡Œé€šçŸ¥ç”¨æˆ·ã€‚
4. æä¾›é…ç½®ï¼šç”¨æˆ·å¯ä»¥æŸ¥è¯¢å½“å‰ redis é›†ç¾¤èŠ‚ç‚¹ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼šæŸ¥è¯¢å“ªä¸ª redis èŠ‚ç‚¹æ˜¯ masterï¼Œå“ªä¸ªæ˜¯ slaveã€‚

> æ•…éšœæ£€æµ‹ï¼Œæ•…éšœå‘ç°ï¼Œæ•…éšœè½¬ç§»ã€‚

---

## 2. èŠ‚ç‚¹å…³ç³»

1. sentinel èŠ‚ç‚¹é—´ç›¸äº’é“¾æ¥é€šä¿¡ã€‚
2. sentinel æ¯ä¸ªèŠ‚ç‚¹ä¸ redis æ¯ä¸ªèŠ‚ç‚¹ç›¸äº’é“¾æ¥é€šä¿¡ã€‚
3. redis èŠ‚ç‚¹ master ä¸ slave ç›¸äº’é“¾æ¥é€šä¿¡ï¼Œæ•°æ®å¤åˆ¶éœ€è¦ã€‚slave ä¹‹é—´ä¸€èˆ¬ä¸ç›¸äº’é“¾æ¥é€šä¿¡ï¼Œé™¤éæ˜¯ `slave` ä¸ `sub-slave` å…³ç³»ã€‚

> sentinel ä¹‹é—´çš„é€šä¿¡ï¼Œsentinel ä¸ redis èŠ‚ç‚¹é—´çš„é€šä¿¡ã€‚

![é«˜å¯ç”¨èŠ‚ç‚¹é€šä¿¡å…³ç³»](/images/2020-06-06-15-48-59.png){:data-action="zoom"}

---

## 3. æ•…éšœè½¬ç§»æµç¨‹

éœ€è¦å¤šä¸ª sentinel ç¡®è®¤ redis èŠ‚ç‚¹æ‰çº¿ï¼Œå¹¶é€‰ä¸¾å…¶ä¸­ä¸€ä¸ª sentinel ä½œä¸º leader è¿›è¡Œæ•…éšœè½¬ç§»ã€‚

1. å…¶ä¸­ä¸€ä¸ª sentinel ç›‘æ§åˆ° master æ‰çº¿ã€‚è¯¥ master è¢«è®¤ä¸ºæ˜¯ä¸»è§‚æ‰çº¿ã€‚
2. æ‰€æœ‰ sentinel éƒ½ç›‘æ§åˆ° master æ‰çº¿ï¼Œè¦æŠŠ master ç¡®è®¤ä¸ºå®¢è§‚æ‰çº¿ã€‚
3. ä» sentinel ä¸­é€‰å‡ºä¸€ä¸ª sentinel ä½œä¸º leader å¯¹ redis é›†ç¾¤è¿›è¡Œæ•…éšœè½¬ç§»ã€‚
4. sentienl leader ä»å‰©ä½™çš„ slave ä¸­ï¼Œé€‰å‡ºä¸€ä¸ªï¼Œå¹¶å°†å…¶è®¾ç½®ä¸º masterã€‚

---

## 4. é—®é¢˜

1. é€‰ä¸¾æµç¨‹ã€‚
2. ç›‘æ§æ•…éšœã€‚
3. å‘ç°æ•…éšœï¼Œä¸»å®¢è§‚æ‰çº¿ã€‚
4. æ•…éšœè½¬ç§»æµç¨‹ã€‚
5. sentinel ä¸ redis é€šä¿¡æµç¨‹ã€‚

---

## 5. å‚è€ƒ

* [Redis Sentinel Documentation](https://redis.io/topics/sentinel)
* [[redis æºç èµ°è¯»] ä¸»ä»æ•°æ®å¤åˆ¶ï¼ˆä¸Šï¼‰](https://wenfh2020.com/2020/05/17/redis-replication/)
* [[redis æºç èµ°è¯»] ä¸»ä»æ•°æ®å¤åˆ¶ï¼ˆä¸‹ï¼‰](https://wenfh2020.com/2020/05/31/redis-replication-next/)
* ã€Šredis å®ç°ä¸è®¾è®¡ã€‹
* [åˆ†å¸ƒå¼ç®—æ³•ä¹‹é€‰ä¸¾ç®—æ³•Raft](https://blog.csdn.net/cainaioaaa/article/details/79881296)

---

> ğŸ”¥æ–‡ç« æ¥æºï¼š[wenfh2020.com](https://wenfh2020.com/)
